{"instance_id": "django__django-14411", "identified_spans": [{"file_path": "django/contrib/auth/forms.py", "span_ids": ["UserChangeForm", "ReadOnlyPasswordHashField", "ReadOnlyPasswordHashField.__init__", "ReadOnlyPasswordHashWidget.get_context", "ReadOnlyPasswordHashWidget"], "content": [{"span_id": "UserChangeForm", "start_line": 135, "end_line": 143, "content": ["class UserChangeForm(forms.ModelForm):\n", "    password = ReadOnlyPasswordHashField(\n", "        label=_(\"Password\"),\n", "        help_text=_(\n", "            'Raw passwords are not stored, so there is no way to see this '\n", "            'user\u2019s password, but you can change the password using '\n", "            '<a href=\"{}\">this form</a>.'\n", "        ),\n", "    )\n"]}, {"span_id": "ReadOnlyPasswordHashField", "start_line": 54, "end_line": 55, "content": ["class ReadOnlyPasswordHashField(forms.Field):\n", "    widget = ReadOnlyPasswordHashWidget\n"]}, {"span_id": "ReadOnlyPasswordHashField.__init__", "start_line": 57, "end_line": 60, "content": ["    def __init__(self, *args, **kwargs):\n", "        kwargs.setdefault(\"required\", False)\n", "        kwargs.setdefault('disabled', True)\n", "        super().__init__(*args, **kwargs)\n"]}, {"span_id": "ReadOnlyPasswordHashWidget.get_context", "start_line": 37, "end_line": 51, "content": ["    def get_context(self, name, value, attrs):\n", "        context = super().get_context(name, value, attrs)\n", "        summary = []\n", "        if not value or value.startswith(UNUSABLE_PASSWORD_PREFIX):\n", "            summary.append({'label': gettext(\"No password set.\")})\n", "        else:\n", "            try:\n", "                hasher = identify_hasher(value)\n", "            except ValueError:\n", "                summary.append({'label': gettext(\"Invalid password format or unknown hashing algorithm.\")})\n", "            else:\n", "                for key, value_ in hasher.safe_summary(value).items():\n", "                    summary.append({'label': gettext(key), 'value': value_})\n", "        context['summary'] = summary\n", "        return context\n"]}, {"span_id": "ReadOnlyPasswordHashWidget", "start_line": 33, "end_line": 35, "content": ["class ReadOnlyPasswordHashWidget(forms.Widget):\n", "    template_name = 'auth/widgets/read_only_password_hash.html'\n", "    read_only = True\n"]}]}]}